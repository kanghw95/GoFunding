<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="User">
	<resultMap type="User" id="resultUser">
		<id property="userId" column="id" />
		<result property="userPwd" column="pwd" />
		<result property="userName" column="name" />
		<result property="userNick" column="nickname" />
		<result property="userPhone" column="phone" />
		<result property="userAddress" column="address" />
		<result property="userEmail" column="email" />
		<result property="gender" column="gender" />
		<result property="userAge" column="age" />
		<result property="userFav" column="fav" />
		<result property="point" column="point" />
		<result property="authority" column="authority" /> 
		<result property="suspensionStart" column="suspensionstart" /> 
		<result property="suspensionFin" column="suspensionfin" /> 
		<result property="reportCnt" column="reportcnt" /> 
		<result property="joinDate" column="joindate"/>
		<result property="loginDate" column="logindate"/>
	</resultMap>
	
	<!-- 회원가입 -->
	<insert id="insertUser" parameterType="User">
		<![CDATA[
		INSERT INTO USERS 
		(ID, PWD, NAME, NICKNAME, PHONE, ADDRESS, EMAIL, GENDER, AGE, FAV, JOINDATE)
		VALUES 
		(#{userId}, #{userPwd}, #{userName}, #{userNick}, #{userPhone}, #{userAddress}, #{userEmail}, #{gender}, #{userAge}, #{userFav}, SYSDATE)
		]]>
	</insert>
	
	<!-- id 중복체크 -->
	<select id="idCheck" parameterType="string" resultType="int">
		SELECT count(*) FROM USERS WHERE id = #{userId}
	</select>
	
	<!-- nickname 중복체크 -->
	<select id="nickCheck" parameterType="string" resultType="User">
		
	</select>
	
	<!-- 로그인 -->
	<select id="logIn" parameterType="string" resultMap="resultUser">
		SELECT * FROM USERS WHERE ID = #{userId} AND PWD = #{userPwd}
	</select>
	
	<!-- 소셜로그인 -->
	<select id="socialLogIn" parameterType="string" resultMap="resultUser">
		SELECT * FROM USERS WHERE NAME = #{userName} AND EMAIL = #{userEmail}
	</select>
	
	<!-- 아이디 찾기 -->
	<select id="findId" parameterType="string" resultMap="resultUser">
		SELECT * FROM USERS WHERE NAME = #{userName} AND EMAIL = #{userEmail} AND PHONE = #{phone}
	</select>
	
	<!-- 펀딩신청서 저장 -->
	<insert id="inputForm">
		INSERT INTO APPLICATION VALUES (SEQ_APPLYNO.NEXTVAL, #{maker}, #{description}, #{id}, #{makerTel},
		#{makerEmail}, #{makerInfo}, #{fundingTitle}, #{fundingCategory}, #{fundingContent}, #{fundingPrice},
		#{fundingStart}, #{fundingFin}, #{fundingPlan}, #{rewardDesc}, #{rewardPrice}, #{rewardTitle}, #{rewardEA}, null)
	</insert>
	
	<!-- 메이커명 중복체크 -->
	<select id="makerChk" parameterType="string" resultType="java.lang.String">
		SELECT MAKER FROM MAKER WHERE MAKER = #{maker}
	</select>
	
</mapper>
